# getty console

have_getty=$($DESTDIR/bin/busybox getty --help  2>&1 | grep -c -i usage)

cat << EOF > $DESTDIR/sbin/rungetty
#!/bin/sh



VEL=38400
CONSOLE_NUMBER=\$1

if [ "\${CONSOLE_NUMBER}" = "" ]; then
  echo "Error: need a console name (example tty1)"
  exit 1
fi


while [ 1 ]; do
  if [ "\$have_getty" = "0" ]; then
    echo "" > /dev/console
    echo "" > /dev/console
    echo "WARNING: getty not found, login disabled" > /dev/console
    sh
  else
    busybox getty \$VEL \$CONSOLE_NUMBER
  fi
done


EOF

chmod +x $DESTDIR/sbin/rungetty


cat << EOF > $DESTDIR/bin/login
#!/bin/sh
busybox login \$@
EOF

chmod +x $DESTDIR/bin/login
